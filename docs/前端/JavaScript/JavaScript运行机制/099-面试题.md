---
title: JavaScript 运行机制的面试题
---

## 栈&堆

### 栈和队列的区别?

栈的插入和删除操作都是在一端进行的，而队列的操作却是在两端进行的。
队列先进先出，栈先进后出。
栈只允许在表尾一端进行插入和删除，而队列只允许在表尾一端进行插入，在表头一端进行删除

### 栈和堆的区别？

栈区（stack）— 内存大小固定，存储基本类型数据，由编译器自动分配释放，运行速度快。后进先出。
堆区（heap） — 内存大小不固定，存储引用类型数据，由程序员分配释放，若程序员不释放，程序结束时可能由垃圾收集器回收。

栈（数据结构）：一种先进后出的数据结构。
堆（数据结构）：堆是在程序运行时，而不是在程序编译时，申请某个大小的内存空间（动态分配内存）。其访问和对一般内存的访问没有区别。

## EventLoop 宏任务和微任务

执行顺序：

- js 引擎会使用解释器去对源代码进行词法分析，构建成抽象语法树，然后再执行。
- js 会先执行全局函数作用域中的所有同步任务，期间遇到异步任务，会按顺序放入任务队列。
- 假如同步任务的执行过程（局部函数作用域）中调用了异步任务，会优先执行同步任务中的异步（上下文环境不同，会开启一个局部任务队列，但相对于父级的执行栈，该任务
  仍旧是同步任务）。
- 每次准备去执行第一个宏任务前，都要将所有的微任务一个一个取出来执行
- 对于 then 的链式调用，只有当前 then 的上一个 then 执行完毕之后，当前 then 才会被加入微任务队列

执行栈的执行顺序：同步函数 => 微队列 => 宏队列

### 微任务和宏任务的区别？

微任务和宏任务一样都是异步任务队列。微任务是局部函数作用域的队列，宏任务是全局作用域的队列。

因为 JavaScript 存在函数作用域，所以当执行栈进入到同步函数内部，就进入了一个新的执行上下文环境。
