<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>js栈内存与堆内存 | 《我的学习笔记》</title>
    <meta name="generator" content="VuePress 1.5.2">
    
    <meta name="description" content="积跬步，至千里！">
    <link rel="preload" href="/assets/css/0.styles.65949c32.css" as="style"><link rel="preload" href="/assets/js/app.a3ee5e69.js" as="script"><link rel="preload" href="/assets/js/2.02e5b305.js" as="script"><link rel="preload" href="/assets/js/42.e9a2bbe3.js" as="script"><link rel="prefetch" href="/assets/js/10.84eca436.js"><link rel="prefetch" href="/assets/js/11.c96fc61b.js"><link rel="prefetch" href="/assets/js/12.7c3e0d4d.js"><link rel="prefetch" href="/assets/js/13.11ca9306.js"><link rel="prefetch" href="/assets/js/14.014e05e4.js"><link rel="prefetch" href="/assets/js/15.5f9ced30.js"><link rel="prefetch" href="/assets/js/16.d420cfe9.js"><link rel="prefetch" href="/assets/js/17.ad9e1cfe.js"><link rel="prefetch" href="/assets/js/18.12766b7b.js"><link rel="prefetch" href="/assets/js/19.8d8e7a3c.js"><link rel="prefetch" href="/assets/js/20.13d2dcdb.js"><link rel="prefetch" href="/assets/js/21.10677bab.js"><link rel="prefetch" href="/assets/js/22.a70617b7.js"><link rel="prefetch" href="/assets/js/23.2aab777d.js"><link rel="prefetch" href="/assets/js/24.1c2aefcb.js"><link rel="prefetch" href="/assets/js/25.7e3732e8.js"><link rel="prefetch" href="/assets/js/26.2ff87a75.js"><link rel="prefetch" href="/assets/js/27.31f9340e.js"><link rel="prefetch" href="/assets/js/28.84933c84.js"><link rel="prefetch" href="/assets/js/29.f9688f21.js"><link rel="prefetch" href="/assets/js/3.5457b81e.js"><link rel="prefetch" href="/assets/js/30.922654fe.js"><link rel="prefetch" href="/assets/js/31.2de4f06f.js"><link rel="prefetch" href="/assets/js/32.66a4ea44.js"><link rel="prefetch" href="/assets/js/33.5d2cb6df.js"><link rel="prefetch" href="/assets/js/34.32164f6f.js"><link rel="prefetch" href="/assets/js/35.d30a0db0.js"><link rel="prefetch" href="/assets/js/36.d0898599.js"><link rel="prefetch" href="/assets/js/37.711cd388.js"><link rel="prefetch" href="/assets/js/38.21f8a295.js"><link rel="prefetch" href="/assets/js/39.5c281311.js"><link rel="prefetch" href="/assets/js/4.7088e4a8.js"><link rel="prefetch" href="/assets/js/40.311449bc.js"><link rel="prefetch" href="/assets/js/41.28837ff0.js"><link rel="prefetch" href="/assets/js/43.f0f1f259.js"><link rel="prefetch" href="/assets/js/44.a7e3159b.js"><link rel="prefetch" href="/assets/js/45.3967626f.js"><link rel="prefetch" href="/assets/js/46.9de806ca.js"><link rel="prefetch" href="/assets/js/47.ad1abfa2.js"><link rel="prefetch" href="/assets/js/48.a11c99c8.js"><link rel="prefetch" href="/assets/js/49.b72698f0.js"><link rel="prefetch" href="/assets/js/5.a7c985c9.js"><link rel="prefetch" href="/assets/js/50.e8478b8e.js"><link rel="prefetch" href="/assets/js/51.4d1c3e21.js"><link rel="prefetch" href="/assets/js/52.851bbc58.js"><link rel="prefetch" href="/assets/js/53.f06ece90.js"><link rel="prefetch" href="/assets/js/54.fadfb3ba.js"><link rel="prefetch" href="/assets/js/55.b4b896ee.js"><link rel="prefetch" href="/assets/js/56.bff4418f.js"><link rel="prefetch" href="/assets/js/57.74ea0e47.js"><link rel="prefetch" href="/assets/js/58.e148de8f.js"><link rel="prefetch" href="/assets/js/59.9f644bea.js"><link rel="prefetch" href="/assets/js/6.6a1b9624.js"><link rel="prefetch" href="/assets/js/60.cc3b0635.js"><link rel="prefetch" href="/assets/js/61.5c19f2f6.js"><link rel="prefetch" href="/assets/js/62.e210caeb.js"><link rel="prefetch" href="/assets/js/63.fd365a6a.js"><link rel="prefetch" href="/assets/js/64.9644790a.js"><link rel="prefetch" href="/assets/js/65.da86dcd2.js"><link rel="prefetch" href="/assets/js/66.9d4696b8.js"><link rel="prefetch" href="/assets/js/67.56cbd6f7.js"><link rel="prefetch" href="/assets/js/68.fd2c8c49.js"><link rel="prefetch" href="/assets/js/69.43f9a80c.js"><link rel="prefetch" href="/assets/js/7.e1a7d743.js"><link rel="prefetch" href="/assets/js/70.722fd346.js"><link rel="prefetch" href="/assets/js/71.a264ea7c.js"><link rel="prefetch" href="/assets/js/72.5469df67.js"><link rel="prefetch" href="/assets/js/73.97d7a495.js"><link rel="prefetch" href="/assets/js/74.749c5801.js"><link rel="prefetch" href="/assets/js/75.583860e6.js"><link rel="prefetch" href="/assets/js/76.6bb0c9ad.js"><link rel="prefetch" href="/assets/js/77.32270007.js"><link rel="prefetch" href="/assets/js/78.1884ee1d.js"><link rel="prefetch" href="/assets/js/79.4c89fbe0.js"><link rel="prefetch" href="/assets/js/8.3b325d0f.js"><link rel="prefetch" href="/assets/js/80.fb7b9221.js"><link rel="prefetch" href="/assets/js/81.6a8b8564.js"><link rel="prefetch" href="/assets/js/82.7ab66fcd.js"><link rel="prefetch" href="/assets/js/83.8fb2322a.js"><link rel="prefetch" href="/assets/js/84.c5758d10.js"><link rel="prefetch" href="/assets/js/85.f7cbd1a1.js"><link rel="prefetch" href="/assets/js/86.e384d7ab.js"><link rel="prefetch" href="/assets/js/87.f8d9b182.js"><link rel="prefetch" href="/assets/js/88.f21d7a2e.js"><link rel="prefetch" href="/assets/js/89.9203e8a9.js"><link rel="prefetch" href="/assets/js/9.10c9abb3.js"><link rel="prefetch" href="/assets/js/90.ab81bea9.js"><link rel="prefetch" href="/assets/js/91.0be1c5ab.js"><link rel="prefetch" href="/assets/js/92.90d04995.js"><link rel="prefetch" href="/assets/js/93.6fac228f.js"><link rel="prefetch" href="/assets/js/94.93c0d4d4.js"><link rel="prefetch" href="/assets/js/95.27405a79.js">
    <link rel="stylesheet" href="/assets/css/0.styles.65949c32.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">《我的学习笔记》</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/前端/Home/目录.html" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="CSS" class="dropdown-title"><span class="title">CSS</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/前端/CSS/01-index.html" class="nav-link">
  页面布局
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="javascript" class="dropdown-title"><span class="title">javascript</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/前端/JavaScript/JavaScript基础知识/01-this.html" class="nav-link">
  JavaScript基础知识
</a></li><li class="dropdown-item"><!----> <a href="/前端/JavaScript/JavaScript运行机制/01-javascript引擎.html" class="nav-link">
  JavaScript运行机制
</a></li><li class="dropdown-item"><!----> <a href="/前端/JavaScript/函数/01-定义函数的方式.html" class="nav-link">
  函数
</a></li><li class="dropdown-item"><!----> <a href="/前端/JavaScript/函数式编程/01-函数式入门.html" class="nav-link">
  函数式编程
</a></li><li class="dropdown-item"><!----> <a href="/前端/javascript/手写api/01-Promise.html" class="nav-link">
  手写api
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="构建工具" class="dropdown-title"><span class="title">构建工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/前端/构建工具/Glup4/01-Gulp.html" class="nav-link">
  Gulp4+
</a></li><li class="dropdown-item"><!----> <a href="/前端/构建工具/Webpack4/01-Webpack.html" class="nav-link">
  Webpack4+
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/计算机/计算机科学/01-Index.html" class="nav-link">
  计算机基础
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="推荐博客" class="dropdown-title"><span class="title">推荐博客</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/mqyqingfeng/Blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端博客-冴羽
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="https://www.lzwlook.fun" target="_blank" rel="noopener noreferrer" class="nav-link external">
  blak-kong
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/前端/Home/目录.html" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="CSS" class="dropdown-title"><span class="title">CSS</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/前端/CSS/01-index.html" class="nav-link">
  页面布局
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="javascript" class="dropdown-title"><span class="title">javascript</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/前端/JavaScript/JavaScript基础知识/01-this.html" class="nav-link">
  JavaScript基础知识
</a></li><li class="dropdown-item"><!----> <a href="/前端/JavaScript/JavaScript运行机制/01-javascript引擎.html" class="nav-link">
  JavaScript运行机制
</a></li><li class="dropdown-item"><!----> <a href="/前端/JavaScript/函数/01-定义函数的方式.html" class="nav-link">
  函数
</a></li><li class="dropdown-item"><!----> <a href="/前端/JavaScript/函数式编程/01-函数式入门.html" class="nav-link">
  函数式编程
</a></li><li class="dropdown-item"><!----> <a href="/前端/javascript/手写api/01-Promise.html" class="nav-link">
  手写api
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="构建工具" class="dropdown-title"><span class="title">构建工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/前端/构建工具/Glup4/01-Gulp.html" class="nav-link">
  Gulp4+
</a></li><li class="dropdown-item"><!----> <a href="/前端/构建工具/Webpack4/01-Webpack.html" class="nav-link">
  Webpack4+
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/计算机/计算机科学/01-Index.html" class="nav-link">
  计算机基础
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="推荐博客" class="dropdown-title"><span class="title">推荐博客</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/mqyqingfeng/Blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端博客-冴羽
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="https://www.lzwlook.fun" target="_blank" rel="noopener noreferrer" class="nav-link external">
  blak-kong
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>JavaScript运行机制</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/前端/JavaScript/JavaScript运行机制/01-javascript引擎.html" class="sidebar-link">JavaScript引擎</a></li><li><a href="/前端/JavaScript/JavaScript运行机制/02-执行上下文.html" class="sidebar-link">js执行上下文</a></li><li><a href="/前端/JavaScript/JavaScript运行机制/03-执行栈与执行过程.html" class="sidebar-link">js执行栈与执行过程</a></li><li><a href="/前端/JavaScript/JavaScript运行机制/04-栈内存与堆内存.html" class="active sidebar-link">js栈内存与堆内存</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/前端/JavaScript/JavaScript运行机制/04-栈内存与堆内存.html#前言" class="sidebar-link">前言</a></li><li class="sidebar-sub-header"><a href="/前端/JavaScript/JavaScript运行机制/04-栈内存与堆内存.html#三种数据结构" class="sidebar-link">三种数据结构</a></li><li class="sidebar-sub-header"><a href="/前端/JavaScript/JavaScript运行机制/04-栈内存与堆内存.html#栈数据结构" class="sidebar-link">栈数据结构</a></li><li class="sidebar-sub-header"><a href="/前端/JavaScript/JavaScript运行机制/04-栈内存与堆内存.html#堆数据结构" class="sidebar-link">堆数据结构</a></li><li class="sidebar-sub-header"><a href="/前端/JavaScript/JavaScript运行机制/04-栈内存与堆内存.html#队列数据结构" class="sidebar-link">队列数据结构</a></li><li class="sidebar-sub-header"><a href="/前端/JavaScript/JavaScript运行机制/04-栈内存与堆内存.html#变量对不同内存的引用" class="sidebar-link">变量对不同内存的引用</a></li><li class="sidebar-sub-header"><a href="/前端/JavaScript/JavaScript运行机制/04-栈内存与堆内存.html#总结" class="sidebar-link">总结</a></li></ul></li><li><a href="/前端/JavaScript/JavaScript运行机制/05-事件循环.html" class="sidebar-link">js事件循环</a></li><li><a href="/前端/JavaScript/JavaScript运行机制/06-内存泄露.html" class="sidebar-link">js内存泄露</a></li><li><a href="/前端/JavaScript/JavaScript运行机制/07-垃圾回收.html" class="sidebar-link">js垃圾回收</a></li><li><a href="/前端/JavaScript/JavaScript运行机制/099-面试题.html" class="sidebar-link">JavaScript 运行机制的面试题</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="前言"><a href="#前言" class="header-anchor">#</a> 前言</h2> <p>关于执行上下文与执行栈、执行过程，已经告一段落。</p> <p>这一章你会了解到:</p> <ul><li><strong>JavaScript 数据结构和事件队列</strong>: 栈内存(stack)、堆内存(heap)、队列(queue)</li> <li>变量的存放</li> <li>内存空间管理</li></ul> <p><strong>栈内存：直接在当前执行栈开辟的内存，大小固定，存储基本类型数据，运行速度快。后进先出。</strong></p> <p><strong>堆内存：执行栈以外的地方开辟内存，大小不固定，存储引用类型数据，引用进行内存地址赋值和调用。</strong></p> <p><strong>队列：javascript 中的任务分为同步任务与异步任务，异步任务不直接执行，会按调用顺序推入队列。</strong></p> <p>同步任务也被称为微任务，异步任务也被称为宏任务。</p> <p><img src="https://image-static.segmentfault.com/171/508/1715085953-5b0fa8a11c20c_articlex" alt="栈内存与堆内存"></p> <h2 id="三种数据结构"><a href="#三种数据结构" class="header-anchor">#</a> 三种数据结构</h2> <p><code>JS</code>中三种重要的数据结构, 如图:</p> <p><img src="https://hexo-blog-1256114407.cos.ap-shenzhen-fsi.myqcloud.com/executionContext2.jpg" alt="img1"></p> <p>(图片来源<a href="https://juejin.im/post/5d870e6651882517a0319aa8" target="_blank" rel="noopener noreferrer">前端九五六-Javascript 内存空间管理<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>)</p> <h2 id="栈数据结构"><a href="#栈数据结构" class="header-anchor">#</a> 栈数据结构</h2> <p><strong>栈的特点</strong>: 后进先出（LIFO）的结构。</p> <p>（<code>LIFO</code>: <code>last-in, first-out</code>，类似于向乒乓球桶中放球，最先放入的球最后取出）</p> <p>这里还是贴上一张网图方便大家理解的好:</p> <p><img src="https://hexo-blog-1256114407.cos.ap-shenzhen-fsi.myqcloud.com/executionContext3.png" alt="img2"></p> <p>栈中的数据就像是一个个乒乓球, 最先进去的最后出来.</p> <p><strong>注 ⚠️</strong></p> <p>这里所说的<strong>进栈</strong>和<strong>出栈</strong>不是指赋值算进, 使用算出. 而是指<strong>赋值算进, 被清理算出</strong>, 而且位于同一函数作用域下的变量, 应该是在栈的同一层.</p> <p>所谓的变量存储于栈内存中的栈，传统意义上说指的是由内存自动创建分配的空间，例如函数的参数值与局部变量，只是其操作方式类似于栈操作，所以叫栈内存。</p> <p>比如函数调用其实就相当于栈的形式:</p> <p><strong>例子 🌰</strong>:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">fn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">fn2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">fn2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">fn3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">fn3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">fn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>如上, 声明的顺序是<code>1, 2, 3</code> , 但是释放的顺序是为<code>3, 2, 1</code> .</p> <p>这里释放按照这个顺序是因为 <code>3</code>最先执行完, 所以最先被释放.</p> <h2 id="堆数据结构"><a href="#堆数据结构" class="header-anchor">#</a> 堆数据结构</h2> <p>一种树状结构。好比 <code>JSON</code> 格式中的数据，你有 <code>key</code>，我有对应的 <code>value</code>, 就立马返给你。</p> <p>因为我们知道<code>JSON</code>格式的存储是无序的, 所以没有先后顺序, 所以它是一种绝对公平的数据结构。</p> <p><strong>注意：引用类型都会开辟堆内存。同时 v8 特性，有 this 指向堆内存保持着引用，该内存就不会释放。</strong></p> <p>如图所示:</p> <img src="https://hexo-blog-1256114407.cos.ap-shenzhen-fsi.myqcloud.com/executionContext4.png" alt="img3" style="zoom:50%;"> <h2 id="队列数据结构"><a href="#队列数据结构" class="header-anchor">#</a> 队列数据结构</h2> <p>队列数据结构不同于堆, 队列是一种 <strong>先进先出(FIFO)</strong> 的数据结构.</p> <p>它也是 <strong>事件循环(Event Loop)</strong> 的基础结构.</p> <p>如图所示:</p> <img src="https://hexo-blog-1256114407.cos.ap-shenzhen-fsi.myqcloud.com/executionContext5.png" alt="img4" style="zoom:50%;"> <p>最先进入队列的任务最先出来, 类似于排队买菜, 排在前面的人先买，并且买完所有菜。才能轮到下一个人（事件）。</p> <blockquote><p>队列的函数处理会一直进行到执行栈再次为空为止，然后事件循环将会处理队列中的下一个消息（如果还有的话）。</p></blockquote> <p>对于 <strong>队列（事件循环）</strong> ，展开来说还有微任务与宏任务。微任务对应执行栈，宏任务对应队列。</p> <h2 id="变量对不同内存的引用"><a href="#变量对不同内存的引用" class="header-anchor">#</a> 变量对不同内存的引用</h2> <h3 id="变量的存放"><a href="#变量的存放" class="header-anchor">#</a> 变量的存放</h3> <p>通过上面的介绍我们知道了, 内存中有堆了栈, 那么<code>JS</code>变量具体是存放在哪里呢?</p> <ul><li>基本数据类型保存在 <strong>栈内存</strong>，与该内存与执行上下文绑定，出栈后自动销毁;</li> <li>引用数据类型保存在 <strong>堆内存</strong>，变量保存了 this 引用，与堆内存绑定，需要 V8 垃圾回收.</li></ul> <ol><li>基本数据类型 6 种: <code>Undefined、Null、Boolean、Number、String、Symbol</code>, 由于他们在内存中分别占有固定大小的空间, 通过按值来访问.</li> <li>引用数据类型: 也就是<code>Object</code>对象, 它的存储分为<strong>访问地址</strong>和<strong>实际存放的地方</strong>; 访问地址是存储在<strong>栈</strong>中的, 当查询引用类型变量的时候, 会先从<strong>栈</strong>中读取内存地址(也就是访问地址), 然后再通过地址找到<strong>堆</strong>中的值.因此, 这种我们也把它叫为<strong>引用访问</strong>.</li></ol> <p><em>一张图方便你理解</em>🤔</p> <img src="https://hexo-blog-1256114407.cos.ap-shenzhen-fsi.myqcloud.com/executionContext6.png" alt="img5" style="zoom:50%;"> <blockquote><p>在计算机的数据结构中，栈比堆的运算速度快，Object 是一个复杂的结构且可以扩展：数组可扩充，对象可添加属性，都可以增删改查。将他们放在堆中是为了不影响栈的效率。而是通过引用的方式查找到堆中的实际对象再进行操作。所以查找引用类型值的时候先去<strong>栈</strong>查找再去<strong>堆</strong>查找。</p></blockquote> <h3 id="变量存放案例"><a href="#变量存放案例" class="header-anchor">#</a> 变量存放案例</h3> <p>要是你读完了上面的<strong>堆栈存储</strong>介绍还有点模糊的话, 我们不妨来看几个案例.</p> <p><strong>案例一 🌰</strong>:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> a<span class="token punctuation">;</span>
b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// a = 1</span>
</code></pre></div><p><strong>案例二 🌰</strong>:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> obj2 <span class="token operator">=</span> obj1<span class="token punctuation">;</span>
obj2<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj1<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// obj1.a = 3</span>
<span class="token comment">// 变量保存引用类型，只能保存到一个引用地址，变量与堆内存不直接绑定！</span>
<span class="token comment">// obj1 和 obj2 都保存了同一个引用地址，指向同一个堆内存，所以堆内存改变会一起改变</span>
</code></pre></div><p><strong>案例三 🌰</strong>:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> obj2 <span class="token operator">=</span> obj1<span class="token punctuation">;</span>
obj1 <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// obj2 = { a: 1 }</span>
<span class="token comment">// 虽然前面 obj1、obj2 都保存了堆内存地址，但后面只有 obj1 把保存的值改成null，所以并不影响 obj2 保存的引用地址指向堆内存。</span>
</code></pre></div><h3 id="内存空间管理"><a href="#内存空间管理" class="header-anchor">#</a> 内存空间管理</h3> <p>在上面我们说了那么多的栈内存, 堆内存, 那么在<code>JS</code>中, 是怎样管理这些内存空间的呢?</p> <p>首先, 同样的, 内存空间也是有属于自己的生命周期, 它主要分为三个阶段:</p> <ol><li>分配你所需的内存;</li> <li>使用分配到的内存(读、写);</li> <li>不需要的时候将其释放、归还.</li></ol> <p>我们可以用个例子来看一下看.</p> <p><strong>案例一 🌰</strong>:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// 在内存中给数值变量分配空间</span>
<span class="token function">alart</span><span class="token punctuation">(</span>a <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 使用内存</span>
a <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">// 使用完后, 释放内存空间</span>
</code></pre></div><p>上面三步分别对应着三个阶段. 当然, <code>a = null</code>这个操作是我们手动将<code>a</code>的内存空间释放. 若没有这个过程, <code>JS</code> 的垃圾回收机制，也会帮助开发者自动做释放内存的工作。</p> <p><strong>垃圾收集器</strong> 会找出那些不再有引用的值，然后释放其占用的内存。会每隔固定的时间段就执行一次释放操作。</p> <p>在自动垃圾收集机制中, 最常用的就是通过 <strong>标记清除</strong> 的算法来找到那些不再继续使用的对象。</p> <p>使用 <code>a = null</code> 就是做了一个释放引用的操作, 让 <code>a</code> 原本对应的值失去引用, 脱离执行环境。<strong>这个值就会在当前执行上下文出栈后，下一次垃圾收集器执行操作时被找到，并被释放.</strong></p> <p>但这也只是变量处于局部执行上下文才容易释放，对于全局执行上下文，因为在整个应用的生命周期中从一打开就处于整个执行栈的最底层，所以难以释放。</p> <p>除了变量全局污染，对于垃圾回收的不利，也是少用全局变量的重要原因。</p> <h2 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h2> <p>栈内存(stack)：栈内存是当前函数作用域的内存，与当前执行上下文绑定。</p> <p>堆内存(heap)：堆内存是区别于栈区、代码区，是独立的另一个内存区域。无法直接赋值给变量，JavaScript 变量的赋值操作，只能引用其内存地址。</p> <p>队列(queue)：事件队列是一种并发模型，当存在多个异步事件，需要队列来调度事件任务的入栈顺序。</p> <p>垃圾回收：栈内存在出栈时，会直接释放。堆内存依赖垃圾收集器每隔一段时间收集标记，判断是否可以释放，只要有变量引用，就不会被回收。对于复杂场景，开发时需注意释放变量。</p> <p>参考文章:</p> <p><a href="https://muyiy.cn/blog/1/1.3.html#%E6%A0%88%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84" target="_blank" rel="noopener noreferrer">木易杨前端进阶-JavaScript 深入之内存空间详细图解<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="https://www.jianshu.com/p/996671d4dcc4" target="_blank" rel="noopener noreferrer">前端基础进阶（一）：内存空间详细图解<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="https://juejin.im/post/5d870e6651882517a0319aa8" target="_blank" rel="noopener noreferrer">前端九五六-Javascript 内存空间管理<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="https://www.zhihu.com/question/57658008" target="_blank" rel="noopener noreferrer">关于 js 中 “栈空间的先进后出，后进先出” 的疑问？<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="https://github.com/LinDaiDai/niubility-coding-js" target="_blank" rel="noopener noreferrer">霖呆呆的 blog<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/前端/JavaScript/JavaScript运行机制/03-执行栈与执行过程.html" class="prev">
        js执行栈与执行过程
      </a></span> <span class="next"><a href="/前端/JavaScript/JavaScript运行机制/05-事件循环.html">
        js事件循环
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.a3ee5e69.js" defer></script><script src="/assets/js/2.02e5b305.js" defer></script><script src="/assets/js/42.e9a2bbe3.js" defer></script>
  </body>
</html>
